<%- include('partials/header') %>

<section class="min-h-screen bg-gray-100 py-8 px-4">
  <div class="max-w-xl mx-auto bg-white shadow-md rounded-lg p-6">
    <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">
      Order #<%= order.id %> Details
    </h2>

    <ul class="space-y-4 text-gray-700 text-sm">
      <li><strong>Status:</strong> <%= order.status %></li>
      <li>
        <strong>Ordered At:</strong> <%= new
        Date(order.createdAt).toLocaleString() %>
      </li>
      <li>
        <strong>Device:</strong> <%= order.Device.name %> by <%=
        order.Device.brand %>
      </li>
      <li><strong>Catalog:</strong> <%= order.Device.catalog %></li>
      <li><strong>Quantity:</strong> <%= order.quantity %></li>
      <li>
        <strong>Price per item:</strong> $<%= order.Device.price.toFixed(2) %>
      </li>
      <li>
        <strong>Total:</strong> $<%= (order.quantity *
        order.Device.price).toFixed(2) %>
      </li>
    </ul>

    <% if (order.Payment) { %>
    <div class="mt-4 p-4 bg-blue-50 rounded">
      <h3 class="font-semibold mb-2">Payment Info</h3>
      <p><strong>Method:</strong> <%= order.Payment.paymentMethod %></p>
      <p><strong>Status:</strong> <%= order.Payment.status %></p>
      <p><strong>Amount:</strong> $<%= order.Payment.amount.toFixed(2) %></p>
      <p><strong>Transaction ID:</strong> <%= order.Payment.transactionId %></p>
    </div>
    <% } %> <% if (order.Shipment) { %>
    <div class="mt-4 p-4 bg-green-50 rounded">
      <h3 class="font-semibold mb-2">Shipment Info</h3>
      <p><strong>Method:</strong> <%= order.Shipment.method %></p>
      <p><strong>Date:</strong> <%= order.Shipment.shipmentDate %></p>
      <p>
        <strong>Finalised:</strong> <%= order.Shipment.finalised ? 'Yes' : 'No'
        %>
      </p>
    </div>
    <% } %>

    <div class="mt-6 flex justify-between">
      <a href="/orders" class="text-blue-600 hover:underline"
        >‚Üê Back to Orders</a
      >

      <% if (order.status === "Placed") { %>
      <form
        action="/orders/cancel/<%= order.id %>"
        method="POST"
        onsubmit="return confirm('Are you sure you want to cancel this order?');"
      >
        <button
          class="bg-red-600 text-white text-sm px-4 py-2 rounded hover:bg-red-700"
        >
          Cancel Order
        </button>
      </form>
      <% } %>
    </div>
  </div>
</section>

<%- include('partials/footer') %>

<%- include('partials/header') -%>

<div class="container mx-auto mt-10 p-6 bg-white shadow-md rounded-lg">
  <h1 class="text-3xl font-bold mb-6 text-gray-800">
    Payment Details for Order #<%= orderId %>
  </h1>

  <% if (errors && errors.length > 0) { %>
  <div
    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4"
    role="alert"
  >
    <strong class="font-bold">Error!</strong>
    <ul>
      <% errors.forEach(function(error) { %>
      <li><%= typeof error === 'object' ? error.msg : error %></li>
      <% }); %>
    </ul>
  </div>
  <% } %> <% if (success && success.length > 0) { %>
  <div
    class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4"
    role="alert"
  >
    <strong class="font-bold">Success!</strong>
    <p><%= success %></p>
  </div>
  <% } %> <% if (payment) { %>
  <div class="space-y-4">
    <div>
      <p class="text-sm text-gray-500">Payment ID</p>
      <p class="text-lg font-semibold text-gray-800"><%= payment.id %></p>
    </div>
    <div>
      <p class="text-sm text-gray-500">Payment Method</p>
      <p class="text-lg font-semibold text-gray-800">
        <%= payment.payment_method %>
      </p>
    </div>
    <div>
      <p class="text-sm text-gray-500">Card Number</p>
      <p class="text-lg font-semibold text-gray-800">
        **** **** **** <%= payment.card_number.slice(-4) %>
      </p>
    </div>
    <div>
      <p class="text-sm text-gray-500">Expiry Date</p>
      <p class="text-lg font-semibold text-gray-800">
        <%= payment.expiry_date %>
      </p>
    </div>
    <div>
      <p class="text-sm text-gray-500">Amount</p>
      <p class="text-lg font-semibold text-gray-800">
        $<%= parseFloat(payment.amount).toFixed(2) %>
      </p>
    </div>
    <div>
      <p class="text-sm text-gray-500">Payment Date</p>
      <p class="text-lg font-semibold text-gray-800">
        <%= new Date(payment.payment_date).toLocaleDateString() %>
      </p>
    </div>
  </div>

  <div class="mt-8 flex space-x-4">
    <a
      href="/orders/<%= orderId %>/payment/edit?paymentId=<%= payment.id %>"
      class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
    >
      Edit Payment
    </a>
    <form
      action="/payment/<%= payment.id %>/delete"
      method="POST"
      onsubmit="return confirm('Are you sure you want to delete this payment record?');"
    >
      <input type="hidden" name="order_id" value="<%= orderId %>" />
      <button
        type="submit"
        class="px-4 py-2 border border-red-500 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
      >
        Delete Payment
      </button>
    </form>
    <a
      href="/orders/view/<%= orderId %>"
      class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
      >Back to Order</a
    >
  </div>
  <% } else { %>
  <p class="text-gray-600">No payment details found for this order.</p>
  <a
    href="/orders/<%= orderId %>/payment"
    class="text-indigo-600 hover:text-indigo-900"
    >Add Payment Details</a
  >
  <% } %>
</div>

<%- include('partials/footer') -%>
